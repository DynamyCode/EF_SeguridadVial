<!DOCTYPE html>
<html lang="en">

    <head>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="">
        <meta name="author" content="">

        <title>M. Operario</title>

        <!-- Bootstrap core CSS -->
        <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom fonts for this template -->
        <link href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:100,200,300,400,500,600,700,800,900" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i" rel="stylesheet">
        <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet">
        <link href="vendor/devicons/css/devicons.min.css" rel="stylesheet">
        <link href="vendor/simple-line-icons/css/simple-line-icons.css" rel="stylesheet">

        <!-- Custom styles for this template -->
        <link href="css/resume.min.css" rel="stylesheet">

    </head>

    <body id="page-top">

        <nav style="background-color: #0634A9" class="navbar navbar-expand-lg navbar-dark bg fixed-top" id="sideNav">
            <a class="navbar-brand js-scroll-trigger" href="#page-top">
                <span class="d-none d-lg-block">
                    <img class="img-fluid img-profile rounded-circle mx-auto mb-2" src="img/profile.jpg" alt="">
                </span>
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link js-scroll-trigger" href="#datosPersonales">DATOS PERSONALES</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link js-scroll-trigger" href="#evaluacion">EVALUACION</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link js-scroll-trigger" href="#salir">SALIR</a>
                    </li>
                </ul>
            </div>
        </nav>

        <div class="container-fluid p-0" style="background-color: #D3D3D3">

            <section class="resume-section p-3 p-lg-5 " id="about">
                <div class="my-auto">
                    <h1 class="mb-0">EVALUACION
                        <!--<span class="text-info">Del Futuro</span>-->
                    </h1><hr>


                    <div id="divIntro" class="container">
                        <div class="col-lg-12 text-center">
                            <video id="vidIntro" class="col-lg-offset-2 col-lg-8 col-lg-offset-2" autoplay controls>
                                <source src="Recursos/intro.mp4" type="video/mp4" />
                                <source src="Recursos/intro.ogg" type="video/ogg" />
                                Su navegador no soporta la reproducción de multimedia
                            </video>
                        </div>
                        <div class="clearfix"></div><br>
                        <div class="col-lg-12 text-center">
                            <button id="btnIniciar" type="button" class="btn btn-primary">Realizar la Evaluacion</button>
                        </div>
                    </div>
                    <div id="divEvaluacion" class="container">
                        <div class="col-lg-12 text-center">
                            <video id="vidEvaluacion" class="col-lg-offset-2 col-lg-8 col-lg-offset-2" controls>
                                <source src="Recursos/Video 1.2.mp4" type="video/mp4"/>
                            </video>
                        </div>
                    </div>
                    <div id="divFinal" class="container">
                        <div class="col-lg-12 text-center">
                            <video id="vidFinal" class="col-lg-offset-2 col-lg-8 col-lg-offset-2" controls>
                            </video>
                        </div>
                    </div>
                    <div id="divResultados">
                        <div class="col-lg-12">
                            <h4>Tus resultados son:</h4><br>
                            <h5 id="cantAciertos">Cantidad de Aciertos: </h5>
                            <h5 id="reaacion">Reacción: </h5>
                        </div>
                        <table class="table col-lg-12">
                            <thead>
                            <th>
                                Riesgos que debias buscar
                            </th>
                            <th>
                                Riesgos encontrados
                            </th>
                            </thead>
                            <tr>
                                <td class="col-lg-6">
                                    <div id="divRiesgos">
                                        <video id="vidEvaluacion" class="col-lg-4" controls>
                                            <source src="Recursos/Video 1.2.mp4#t=33,36" type="video/mp4"/>
                                        </video>
                                        <video id="vidEvaluacion" class="col-lg-4" controls>
                                            <source src="Recursos/Video 1.2.mp4#t=65,73" type="video/mp4"/>
                                        </video>
                                        <video id="vidEvaluacion" class="col-lg-4" controls>
                                            <source src="Recursos/Video 1.2.mp4#t=131,134" type="video/mp4"/>
                                        </video>
                                        <video id="vidEvaluacion" class="col-lg-4" controls>
                                            <source src="Recursos/Video 1.2.mp4#t=150,154" type="video/mp4"/>
                                        </video>
                                    </div>
                                </td>
                                <td class="col-lg-12">
                                    <div id="divRiesgosEncontrados" class="col-lg-6">
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <audio src="Recursos/sonido1.ogg" id="audClicVideo">  
                    Tu navegador no soporta el elemento 
                    <code>audio</code>
                </audio>
            </section>
        </div>

        <!-- Bootstrap core JavaScript -->
        <script src="vendor/jquery/jquery.min.js"></script>
        <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

        <!-- Plugin JavaScript -->
        <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

        <!-- Custom scripts for this template -->
        <!--<script src="js/resume.min.js"></script>-->

        <script src="js/jquery.min.js"></script>
        <script src="js/jquery.easing.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/wow.js"></script>
        <script>
            function puntoRiesgo(inicio, fin) {
                this.inicio = inicio;
                this.fin = fin;
            }
            function puntoRiesgoUser(inicio) {
                this.inicio = inicio;
                this.acierto = 0;
                this.reaccion = 0;
            }
        </script>
        <script>
            $(document).ready(function () {
                var vidEvaluacion = document.getElementById("vidEvaluacion");
                var objArrayRiesgos = [new puntoRiesgo(33, 36)
                            , new puntoRiesgo(65, 73)
                            , new puntoRiesgo(131, 134)
                            , new puntoRiesgo(150, 154)
                            , new puntoRiesgo(187, 189)
                            , new puntoRiesgo(237, 240)
                            , new puntoRiesgo(252, 255)];

                var objArrayRiesgosUser = new Array();
                var cantAciertos = 0;
                var sumReaccion = 0;

                $("#btnIniciar").hide();
                $("#divEvaluacion").hide();
                $("#divFinal").hide();
                $("#divResultados").hide();

                $("#vidIntro").on('ended', function () {
                    $("#btnIniciar").show("slow");
                });

                $("#btnIniciar").click(function () {
                    $("#divIntro").hide("slow");
                    $("#divEvaluacion").show();
                    vidEvaluacion.play();
                });

                $("#vidEvaluacion").on('click', function () {
                    objArrayRiesgosUser.push(new puntoRiesgoUser(vidEvaluacion.currentTime));
                    var audClicVideo = document.getElementsByTagName("audio")[0];
                    audClicVideo.play();
                });

                $("#vidEvaluacion").on('ended', function () {
                    for (i = 0; i < objArrayRiesgosUser.length; i++) {
                        for (j = 0; j < objArrayRiesgos.length; j++) {
                            var inicio = objArrayRiesgos[j].inicio;
                            var fin = objArrayRiesgos[j].fin;
                            var promAcierto = (inicio + fin) / 2;
                            if (objArrayRiesgosUser[i].inicio >= inicio & objArrayRiesgosUser[i].inicio <= fin) {
                                objArrayRiesgosUser[i].acierto = 1;
                                objArrayRiesgosUser[i].reaccion = promAcierto - objArrayRiesgosUser[i].inicio;
                            }
                        }
                    }
                    for (i = 0; i < objArrayRiesgosUser.length; i++) {
                        if (objArrayRiesgosUser[i].acierto === 1) {
                            cantAciertos = cantAciertos + 1;
                            sumReaccion = sumReaccion + objArrayRiesgosUser[i].reaccion;
                        }
                        console.log("Click: " + objArrayRiesgosUser[i].inicio + " --|-- "
                                + "Acierto: " + objArrayRiesgosUser[i].acierto + " --|-- "
                                + "Reaccion: " + objArrayRiesgosUser[i].reaccion + " --|-- ");
                    }
                    console.log("Cantidad aciertos: + " + cantAciertos);
                    console.log("Suma reacción: + " + sumReaccion);
                    console.log("Porcentaje aciertos: + " + cantAciertos / objArrayRiesgos.length);
                    console.log("Promedio reacción: " + sumReaccion / cantAciertos);

                    $("#divEvaluacion").hide();
                    $("#divFinal").show("slow");

                    if (cantAciertos / objArrayRiesgos.length > 0.66) {
                        var vidFinal = document.getElementById("vidFinal");
                        vidFinal.play();
                    } else if (cantAciertos / objArrayRiesgos.length > 0.33) {
                        var vidFinal = document.getElementById("vidFinal");
                        vidFinal.play();
                    } else {
                        var vidFinal = document.getElementById("vidFinal");
                        $("#vidFinal").html('<source src="Recursos/01 - PuntuacionAlta.mp4" type="video/mp4"></source>');
                        vidFinal.play();
                    }
                });
            });
            $("#vidFinal").on('ended', function () {
                $("#divFinal").hide();
                $("#divResultados").show("slow");
                $("#cantAciertos").append($("#cantAciertos").val() + "2");
                $("#reaacion").append($("#reaacion").val() + "2");
            });
        </script>

    </body>



</html>


